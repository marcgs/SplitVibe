# SplitVibe — Product Specification

**Version:** 0.2
**Date:** 2026-02-20
**Status:** Draft

---

## 1. Overview

SplitVibe is a shared-expense tracking app for friends and family — a Splitwise-style tool that lets groups record expenses, split costs in flexible ways, track who owes whom, and mark debts as settled. It targets both web and mobile users via a Progressive Web App (PWA) and focuses on simplicity, fairness, and multi-currency support.

---

## 2. Goals & Non-Goals

### Goals
- Let groups of people record and split shared expenses.
- Support flexible split modes: equal, percentage, and weighted shares.
- Track balances per group and across the platform.
- Automatically simplify debts to minimize the number of required payments.
- Support multi-currency expenses with stored FX rates via Frankfurter (ECB).
- Allow users to upload receipts or attachments to expenses.
- Provide a frictionless social login experience (Google, Apple).

### Non-Goals (v1)
- Real payment processing or integration with payment providers.
- Recurring/scheduled expenses.
- In-app notifications, email alerts, or push notifications.
- Expense comments or activity log.
- Direct (non-group) expenses between two users.

---

## 3. Users & Access

| Surface | Description |
|--------|-------------|
| **Web app** | Full-featured browser-based interface, responsive for desktop and tablet. |
| **Mobile (PWA)** | The web app is a PWA — installable on iOS and Android home screens, no app store submission required. One codebase for all surfaces. |

All surfaces share the same backend and data.

---

## 4. Authentication

- **Social login only** — no email/password registration.
- Supported providers (at minimum): **Google**, **Apple**.
- On first login, a user profile is created automatically (display name and avatar pulled from provider, both editable afterwards).
- Users are identified across the app by their provider account; no manual profile setup required.

---

## 5. Core Concepts

### 5.1 Users
A user is anyone who has registered via social login. Users have:
- Display name and avatar (from social provider, editable).
- A preferred display currency for the global dashboard.
- A list of groups they belong to.
- A global balance summary across all groups.

### 5.2 Groups
A group is the central organizing unit. All expenses belong to a group.

- A group has a name, optional description, and optional cover image.
- A group is created by one user (the **creator**) who automatically becomes its first member.
- A group can be created with only one member; expenses can be added before others join.
- Members are invited via a **shareable invite link** generated per group. Anyone with the link can join.
- Invite links can be revoked and regenerated by any group member.
- There is no concept of group "owner" beyond creation — all members have equal permissions.
- A group can be **archived** (read-only, no new expenses) but not deleted while any member has a non-zero balance.

### 5.3 Member Lifecycle

**Leaving a group:**
- A member cannot leave a group while they have a non-zero balance (positive or negative) in that group.
- Once their balance is zero, they can leave; their historical expenses remain visible.

**Removing a member:**
- Any group member can attempt to remove another member.
- Removal is blocked if the target member has a non-zero balance in the group.
- Once removed, the member loses access but their historical expenses remain.

### 5.4 Expenses
An expense represents a real-world cost that one or more people paid and want to split.

| Field | Details |
|-------|---------|
| **Title** | Short description (e.g. "Dinner at Nobu"). |
| **Amount** | Numeric value in the expense's chosen currency. |
| **Currency** | ISO 4217 currency code (e.g. USD, EUR, GBP). |
| **Paid by** | One or more members who covered the cost, each with their contributed amount. Amounts must sum to the total. |
| **Split among** | Subset of group members sharing the cost. The payer may be excluded from the split. |
| **Split mode** | How the cost is divided among split participants (see §6). |
| **Date** | Date the expense occurred (defaults to today). |
| **Attachments** | Zero or more images or files (e.g. receipt photos). |
| **Group** | The group this expense belongs to. |

**Payer rules:**
- Multiple members can share the "paid by" role, each covering a portion of the total.
- A payer does not have to be included in the split (they may have paid on behalf of others).

**Editing expenses:**
- Only the member who created the expense can edit or delete it.
- Editing is allowed even after related settlements have been recorded. Balances are recalculated automatically; existing settlement records remain unchanged.

**Deletion:**
- Deleted expenses are **soft-deleted** — marked inactive and hidden from the UI, but retained in the database for audit and balance history purposes.

### 5.5 Settlements
A settlement records that one member paid another to settle a debt.

- Any member can record a settlement between any two members of the same group.
- Settlements are not processed as real payments — they are manual records only.
- A settlement can be deleted by any group member within **24 hours** of creation.
- Settlements are also soft-deleted if removed.

---

## 6. Split Modes

All splits apply to the total expense amount, distributed among the selected split participants.

| Mode | Description | Example |
|------|-------------|---------|
| **Equal** | Divide the total evenly among all selected participants. | $90 split 3 ways → $30 each. |
| **Percentage** | Each participant is assigned a percentage; percentages must sum to 100%. | $90: Alice 50%, Bob 30%, Carol 20% → $45, $27, $18. |
| **Shares** | Each participant is assigned a weight; amounts are proportional to weights. | $90: Alice ×2, Bob ×1, Carol ×1 → $45, $22.50, $22.50. |

**Rounding:** Any remainder from minor-unit rounding is assigned to the first participant alphabetically. If the payer is a split participant, they receive the remainder instead.

---

## 7. Multi-Currency

- Each expense is recorded in any ISO 4217 currency chosen at the time of entry.
- Group balances are displayed in a **group base currency** set at group creation (changeable later by any member).
- **FX provider:** [Frankfurter](https://www.frankfurter.app/) — free, no API key required, backed by European Central Bank data.
- **Rate refresh:** Exchange rates are fetched and cached **once per day**.
- The exchange rate applied at the time of expense creation is **stored with the expense** and never retroactively updated, even if the group base currency is later changed.
- **Base currency change:** When the group base currency is changed, only new expenses use the new currency for conversion. All historical expenses retain the rate and base-currency equivalent stored at creation time.
- On the global dashboard, per-group balances are converted to the user's **preferred display currency** using the latest cached rate.

---

## 8. Debt Simplification

SplitVibe automatically simplifies group balances to reduce the number of required payments.

**Algorithm:** Given the set of net balances within a group, compute the minimum set of directed payments that zeroes all balances (greedy min-cash-flow). Simplification is recalculated whenever an expense or settlement is added, edited, or removed.

**Example:**
- Raw: A owes B £20, B owes C £20.
- Simplified: A owes C £20 (B is eliminated as an intermediary).

Simplification is applied per-group and presented as suggested settlements. Users may record settlements in any amount or direction — suggestions are non-binding.

---

## 9. Attachments

- Users can attach one or more files to an expense at creation or edit time.
- **Limits:** 10 MB per file, up to 5 files per expense.
- **Supported types:** JPEG, PNG, WebP, HEIC, PDF.
- Files are stored in cloud object storage and served via short-lived signed URLs.
- Attachments are viewable by all current group members.

---

## 10. Balances & Reporting

### Per-Group View
- Net balance for the current user within the group (positive = owed to you, negative = you owe).
- Simplified debt list: who owes whom and how much, displayed in the group base currency.
- Full expense history with filters (date range, paid by).

### Global Dashboard
- Total balance across all groups converted to the user's preferred display currency.
- Per-group balance breakdown with a link to each group.
- List of pending suggested settlements across all groups.

---

## 11. Permissions & Access Control

| Action | Who can do it |
|--------|--------------|
| Create a group | Any authenticated user |
| Invite members (generate/revoke link) | Any group member |
| Add an expense | Any group member |
| Edit an expense | The member who created it |
| Delete an expense | The member who created it |
| Record a settlement | Any group member |
| Delete a settlement | Any group member (within 24 h of creation) |
| Remove a member | Any group member (only if target balance is zero) |
| Leave a group | The member themselves (only if their balance is zero) |
| Change group base currency | Any group member |
| Archive a group | Any group member (only if all balances are zero) |

---

## 12. Out-of-Scope Features (Future Consideration)

The following are explicitly out of scope for v1 but may be revisited:

- Real payment integrations (Venmo, PayPal, Stripe, etc.)
- Recurring/scheduled expenses
- Push, email, or in-app notifications
- Expense comments and activity log
- Direct (non-group) one-on-one expenses
- Expense categories / tagging
- Export to CSV/PDF
- AI-powered receipt scanning
- Native mobile app (React Native / Expo)
